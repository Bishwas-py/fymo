# Fymo Framework Restructuring Plan

## Current Structure (Monolithic)
```
fymo/
├── server.py           # Main server code mixed with app code
├── controllers/        # User's app code
├── templates/          # User's templates
├── routes/            # User's routes
├── js_runtime.py      # Framework core
├── svelte_compiler.py # Framework core
└── venv/
```

## Proposed Structure (Package + Project)

### 1. Framework Package Structure
```
fymo/                           # Root directory
├── pyproject.toml             # Modern Python packaging
├── setup.py                   # For backwards compatibility
├── README.md                  # Framework documentation
├── LICENSE                    # MIT or Apache 2.0
├── MANIFEST.in               # Include non-Python files
├── requirements.txt          # Framework dependencies
├── package.json              # For Svelte runtime building
├── .gitignore
│
├── fymo/                     # The actual package
│   ├── __init__.py          # Package initialization
│   ├── __version__.py       # Version info
│   │
│   ├── core/                # Core framework components
│   │   ├── __init__.py
│   │   ├── server.py        # WSGI application factory
│   │   ├── runtime.py       # JS/Svelte runtime (was js_runtime.py)
│   │   ├── compiler.py      # Svelte compiler (was svelte_compiler.py)
│   │   ├── router.py        # Routing system
│   │   └── middleware.py    # Middleware support
│   │
│   ├── cli/                 # CLI commands
│   │   ├── __init__.py
│   │   ├── main.py         # Entry point for CLI
│   │   ├── commands/
│   │   │   ├── __init__.py
│   │   │   ├── new.py      # fymo new <project>
│   │   │   ├── generate.py # fymo generate <component>
│   │   │   ├── serve.py    # fymo serve
│   │   │   └── build.py    # fymo build
│   │   └── templates/      # Project templates
│   │       ├── project/    # Default project template
│   │       └── component/  # Component templates
│   │
│   ├── bundler/            # Build tools
│   │   ├── __init__.py
│   │   ├── runtime_builder.py
│   │   └── js/
│   │       └── build_runtime.js
│   │
│   └── utils/              # Utilities
│       ├── __init__.py
│       ├── colors.py       # Terminal colors (rigids replacement)
│       └── helpers.py
│
├── tests/                  # Framework tests
│   ├── __init__.py
│   ├── test_compiler.py
│   ├── test_runtime.py
│   └── test_cli.py
│
└── examples/               # Example projects
    ├── blog/
    ├── todo-app/
    └── dashboard/
```

### 2. User Project Structure (Generated by `fymo new`)
```
my-app/                     # User's project
├── fymo.yml               # Project configuration (replaces routes.yml)
├── requirements.txt       # Project dependencies (includes fymo)
├── package.json          # Frontend dependencies
├── .gitignore
├── README.md
│
├── app/                   # Application code
│   ├── __init__.py
│   ├── controllers/       # Python controllers
│   │   ├── __init__.py
│   │   └── posts.py
│   │
│   ├── templates/        # Svelte templates
│   │   └── posts/
│   │       └── index.svelte
│   │
│   ├── models/           # Data models (optional)
│   │   └── __init__.py
│   │
│   └── static/           # Static assets
│       ├── css/
│       ├── js/
│       └── images/
│
├── config/               # Configuration
│   ├── __init__.py
│   ├── settings.py      # App settings
│   └── routes.py        # Route definitions
│
├── dist/                # Build output (gitignored)
│   └── svelte-runtime.js
│
└── server.py            # Entry point (minimal)
```

## Installation & Usage

### For Framework Development
```bash
# Clone and install in development mode
git clone https://github.com/yourusername/fymo
cd fymo
pip install -e .  # Editable install
```

### For End Users
```bash
# Install from PyPI
pip install fymo

# Create new project
fymo new my-app
cd my-app

# Generate a component
fymo generate component posts/show

# Run development server
fymo serve
# or
python server.py

# Build for production
fymo build
```

## Key Files to Create

### 1. `pyproject.toml`
```toml
[build-system]
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "fymo"
version = "0.1.0"
description = "Production-ready Python SSR framework for Svelte 5"
authors = [{name = "Your Name", email = "your@email.com"}]
dependencies = [
    "stpyv8>=13.1.201.22",
    "pyyaml>=6.0",
    "gunicorn>=23.0.0",
]

[project.scripts]
fymo = "fymo.cli.main:main"

[project.optional-dependencies]
dev = ["pytest", "black", "flake8"]
```

### 2. `fymo/__init__.py`
```python
"""Fymo - Python SSR Framework for Svelte 5"""

from fymo.core.server import create_app
from fymo.__version__ import __version__

__all__ = ['create_app', '__version__']
```

### 3. `fymo/cli/main.py`
```python
#!/usr/bin/env python3
import click
from fymo.cli.commands import new, generate, serve, build

@click.group()
@click.version_option()
def cli():
    """Fymo - Python SSR Framework for Svelte 5"""
    pass

cli.add_command(new.new)
cli.add_command(generate.generate)
cli.add_command(serve.serve)
cli.add_command(build.build)

def main():
    cli()

if __name__ == "__main__":
    main()
```

### 4. User's `server.py` (generated)
```python
#!/usr/bin/env python3
"""Entry point for Fymo application"""

from fymo import create_app
from config import settings

# Create the WSGI application
app = create_app(settings)

if __name__ == "__main__":
    import fymo.cli.commands.serve as serve
    serve.run_server(app, host="127.0.0.1", port=8000)
```

### 5. `fymo.yml` (replaces routes.yml)
```yaml
# Fymo project configuration
name: my-app
version: 1.0.0

# Routing configuration
routes:
  root: posts.index
  resources:
    - posts
    - comments

# Build configuration
build:
  output_dir: dist
  minify: false
  
# Server configuration  
server:
  host: 127.0.0.1
  port: 8000
  reload: true
```

## Benefits of This Structure

1. **Installable via pip**: `pip install fymo`
2. **Clear separation**: Framework code vs user code
3. **CLI tools**: Professional CLI experience
4. **Extensible**: Easy to add plugins/middleware
5. **Testable**: Proper test structure
6. **Examples included**: Learn by example
7. **Modern Python**: Uses pyproject.toml
8. **Development friendly**: Editable installs work
9. **Production ready**: Clear build process
10. **Familiar structure**: Similar to Django/Flask

## Migration Steps

1. Create the new directory structure
2. Move core files to `fymo/core/`
3. Create CLI commands
4. Set up packaging files
5. Create project template
6. Write tests
7. Create examples
8. Publish to PyPI

This structure makes Fymo a professional, installable framework while keeping it easy to develop and extend!
